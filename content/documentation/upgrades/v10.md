---
title: Upgrade to 10.x
weight: 1
description: 'Guide on how to upgrade to GenHTTP 10 from version 9.x'
cascade:
  type: docs
---

### Dependency Injection

In GenHTTP 10, support for dependency injection 
[has been added](../../content/concepts/dependency-injection/). If you are using
custom mechanisms to achieve dependency injection, you might want to switch
to the new, built-in way.

### Asynchronous Websocket Callbacks

In versions prior to GenHTTP 10, and following the design of Fleck, the callbacks of the websocket handler were synchronous, whereas the methods provided by the websocket connection were asynchronous (meaning that `socket.Send()` returns a `Task`). This was non-intuitive, leading consumers of that API to think that the operation were blocking.

Example in GenHTTP 9:

```csharp
Websocket.Create()
         .OnOpen(c => 
         {
           c.Send("One");
           c.Send("Two");

           c.Close(); 
         });
```

In GenHTTP 10, the callbacks accepted by the handler are expected to be asynchronous, and the methods have been renamed to include the `Async` postfix:

```csharp
Websocket.Create()
         .OnOpen(async c => 
         {
           await c.SendAsync("One"); 
           await c.SendAsync("Two"); 

           c.Close(); 
         });
```

If there is no need for asynchronous execution in a event handler, you can return a completed task instead:

```csharp
Websocket.Create()
         .OnOpen(_ => 
         {
           Console.WriteLine("Someone connected.");
           return Task.CompletedTask;
         });
```